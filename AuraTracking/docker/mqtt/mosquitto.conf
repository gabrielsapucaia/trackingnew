# ============================================
# Mosquitto MQTT Broker Configuration
# AuraTracking Telemetry System
# ============================================

# --------------------------------------------
# General Settings
# --------------------------------------------

# Allow remote connections (not just localhost)
listener 1883 0.0.0.0

# WebSocket listener (optional, for web clients)
listener 9001 0.0.0.0
protocol websockets

# --------------------------------------------
# Security Settings
# --------------------------------------------

# Allow anonymous connections (no username/password)
# WARNING: Set to false in production and configure authentication
allow_anonymous true

# For production, uncomment and configure:
# allow_anonymous false
# password_file /mosquitto/config/passwd
# acl_file /mosquitto/config/acl

# --------------------------------------------
# Persistence Settings
# --------------------------------------------

# Enable message persistence
persistence true

# Location for persistent data
persistence_location /mosquitto/data/

# Autosave interval in seconds (0 = only on shutdown)
autosave_interval 60

# Autosave on changes
autosave_on_changes true

# --------------------------------------------
# Logging Settings
# --------------------------------------------

# Log to file
log_dest file /mosquitto/log/mosquitto.log

# Also log to stdout for Docker
log_dest stdout

# Log types to include
log_type error
log_type warning
log_type notice
log_type information

# Include timestamps in logs
log_timestamp true
log_timestamp_format %Y-%m-%dT%H:%M:%S

# Connection logging
connection_messages true

# --------------------------------------------
# Message Settings
# --------------------------------------------

# Maximum packet size (default: 0 = no limit)
max_packet_size 0

# Maximum inflight messages
max_inflight_messages 20

# Maximum queued messages (0 = no limit)
max_queued_messages 1000

# Message retry interval
retry_interval 20

# --------------------------------------------
# Connection Settings
# --------------------------------------------

# Keepalive interval
max_keepalive 120

# Socket timeout
socket_timeout 120

# --------------------------------------------
# Topic ACL (Access Control)
# Default: Allow all topics under aura/tracking/#
# --------------------------------------------

# For production, create an ACL file with:
# topic readwrite aura/tracking/#
# topic read $SYS/#

# --------------------------------------------
# Sys Topics
# --------------------------------------------

# Update interval for $SYS topics (seconds)
sys_interval 10
